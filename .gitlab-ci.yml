image: microsoft/dotnet:latest

stages:
  - publish

variables:
  project: "NoData"

publish:
  stage: publish
  variables:
    build_path: "$project"
  environment:
    name: production
  script:
    - "cd $build_path"
    - "rm -rf bin"
    - "dotnet pack -v q /warnaserror -c Release"
    - "cd bin/Release"
    - dotnet nuget push ./*.nupkg --source https://api.nuget.org/v3/index.json --api-key $NUGET
